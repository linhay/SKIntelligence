# 2026-02-13

## ACP 业务域收口（Runtime + Session Persistence）
- 决策：将 FS/Terminal 运行时从 CLI 内嵌实现上提为 `SKIACPClient` 可复用抽象，避免 CLI 与协议处理层耦合。
- 新增：
  - `ACPFilesystemRuntime`、`ACPLocalFilesystemRuntime`（含 rooted 访问策略）
  - `ACPTerminalRuntime`、`ACPProcessTerminalRuntime`
  - `ACPClientService.installRuntimes(filesystem:terminal:)`
- 新增：`SKIAgentSession.enableJSONLPersistence(fileURL:configuration:)`，用于跨 session transcript 恢复。
- 验证：`ACPClientRuntimeTests` + `SKIAgentSession` 持久化测试通过；ACP/CLI 相关回归通过。
- 风险：rooted 路径策略当前基于标准化路径与前缀判断，复杂符号链接场景需后续补充更严格 realpath 校验。
